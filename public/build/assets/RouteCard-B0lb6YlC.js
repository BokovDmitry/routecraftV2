import{r as d,j as s,J as g,b as p}from"./app-BiCOU7zL.js";import{f as T,a as B,d as D}from"./dubai-1WBGI7KM.js";import{c,u as n,a as I}from"./Row-CJlQkx92.js";const y=e=>d.forwardRef((a,t)=>s.jsx("div",{...a,ref:t,className:c(a.className,e)})),h=d.forwardRef(({className:e,bsPrefix:a,as:t="div",...o},r)=>(a=n(a,"card-body"),s.jsx(t,{ref:r,className:c(e,a),...o})));h.displayName="CardBody";const j=d.forwardRef(({className:e,bsPrefix:a,as:t="div",...o},r)=>(a=n(a,"card-footer"),s.jsx(t,{ref:r,className:c(e,a),...o})));j.displayName="CardFooter";const v=d.createContext(null);v.displayName="CardHeaderContext";const C=d.forwardRef(({bsPrefix:e,className:a,as:t="div",...o},r)=>{const i=n(e,"card-header"),m=d.useMemo(()=>({cardHeaderBsPrefix:i}),[i]);return s.jsx(v.Provider,{value:m,children:s.jsx(t,{ref:r,...o,className:c(a,i)})})});C.displayName="CardHeader";const w=d.forwardRef(({bsPrefix:e,className:a,variant:t,as:o="img",...r},i)=>{const m=n(e,"card-img");return s.jsx(o,{ref:i,className:c(t?`${m}-${t}`:m,a),...r})});w.displayName="CardImg";const k=d.forwardRef(({className:e,bsPrefix:a,as:t="div",...o},r)=>(a=n(a,"card-img-overlay"),s.jsx(t,{ref:r,className:c(e,a),...o})));k.displayName="CardImgOverlay";const R=d.forwardRef(({className:e,bsPrefix:a,as:t="a",...o},r)=>(a=n(a,"card-link"),s.jsx(t,{ref:r,className:c(e,a),...o})));R.displayName="CardLink";const H=y("h6"),$=d.forwardRef(({className:e,bsPrefix:a,as:t=H,...o},r)=>(a=n(a,"card-subtitle"),s.jsx(t,{ref:r,className:c(e,a),...o})));$.displayName="CardSubtitle";const b=d.forwardRef(({className:e,bsPrefix:a,as:t="p",...o},r)=>(a=n(a,"card-text"),s.jsx(t,{ref:r,className:c(e,a),...o})));b.displayName="CardText";const S=y("h5"),E=d.forwardRef(({className:e,bsPrefix:a,as:t=S,...o},r)=>(a=n(a,"card-title"),s.jsx(t,{ref:r,className:c(e,a),...o})));E.displayName="CardTitle";const F=d.forwardRef(({bsPrefix:e,className:a,bg:t,text:o,border:r,body:i=!1,children:m,as:l="div",...f},u)=>{const N=n(e,"card");return s.jsx(l,{ref:u,...f,className:c(a,N,t&&`bg-${t}`,o&&`text-${o}`,r&&`border-${r}`),children:i?s.jsx(h,{children:m}):m})});F.displayName="Card";const x=Object.assign(F,{Img:w,Title:E,Subtitle:$,Body:h,Link:R,Text:b,Header:C,Footer:j,ImgOverlay:k}),A="/build/assets/heart-8iC9_XJY.png",O="/build/assets/delete-6qmEIWpD.png";function W({route:e,currentUser:a,showControls:t=!1,isMyRoutesPage:o=!1}){const[r,i]=d.useState([]);d.useEffect(()=>{(async()=>{try{const u=(await p.get("/saved-routes")).data.map(N=>N.route_id);i(u)}catch(f){console.error("Error fetching saved routes:",f)}})()},[]);const m=async l=>{const f=r.includes(l);try{f?(i(u=>u.filter(N=>N!==l)),await p.delete(`/saved-routes/${l}`),console.log("Route removed successfully")):(i(u=>[...u,l]),await p.post("/saved-routes",{route_id:l}),console.log("Route saved successfully"))}catch(u){console.error("Error toggling favorite:",u)}};return s.jsx(I,{xs:"auto",children:s.jsx(g,{href:`/routes/${e.id}`,className:"text-decoration-none text-dark",children:s.jsxs(x,{className:`route-card shadow-sm position-relative mx-auto ${a&&e.user&&a.id===e.user.id?"has-controls":""}   ${o?"my-routes-card":""}`,children:[s.jsx("div",{className:"bookmark-icon",onClick:l=>{l.preventDefault(),m(e.id)},title:"Add to favorites",children:s.jsx("img",{src:r.includes(e.id)?T:B,alt:"bookmark"})}),s.jsx(x.Img,{variant:"top",src:e.image===null?D:`/storage/${e.image}`,alt:e.image===null?"No Image":e.title,className:"route-image"}),s.jsxs(x.Body,{className:"route-info",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[s.jsx(x.Title,{as:"h6",className:"mb-0 route-title-truncated",children:e.title}),s.jsxs("span",{className:"text-muted small flex-shrink-0",children:[e.days," Days"]})]}),s.jsx(x.Subtitle,{className:"mb-1 text-muted small",children:e.user?`by ${e.user.name}`:"Unknown Author"}),s.jsxs("div",{className:"d-flex justify-content-between align-items-start mt-2",children:[e.description?s.jsx(x.Text,{className:"route-description mb-0 flex-grow-1 me-2 text-truncate",children:e.description}):s.jsx("span",{className:"route-description text-muted small",children:"Â "}),s.jsxs("div",{className:"d-flex align-items-center likes-section ms-2",children:[s.jsx("img",{src:A,alt:"likes",className:"heart-icon me-1"}),s.jsx("span",{className:"small likes-count",children:e.likes})]})]}),t&&a&&e.user&&a.id===e.user.id&&s.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3 route-actions",children:[s.jsx(g,{href:`/routes/${e.id}/edit`,title:"Edit Route",className:"edit-button",onClick:l=>l.stopPropagation(),children:"Edit"}),s.jsx("button",{onClick:async l=>{if(l.preventDefault(),l.stopPropagation(),confirm("Are you sure you want to delete this route?"))try{await p.delete(`/routes/${e.id}`),console.log("Route deleted successfully"),window.location.reload()}catch(f){console.error("Error deleting route:",f),alert("Failed to delete the route. Please try again.")}},title:"Delete Route",className:"icon-button",children:s.jsx("img",{src:O,alt:"Delete",className:"action-icon"})})]})]})]})})},e.id)}export{W as R};
