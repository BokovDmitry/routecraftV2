import{r as m,j as e,b as E}from"./app-BUkYBJdy.js";import{N as L}from"./Navbar-CQasr33c.js";import{C as P,R as u,a as p,F as _}from"./Row-BD8xuxxM.js";import{i as G,a as O,b as R}from"./remove-ICyhTtfO.js";import{B as g}from"./CreateRoute-BaPprqf5.js";import{F as r}from"./Form-C40tDxfK.js";/* empty css                 */function U({existingRoute:l}){const[o,b]=m.useState({title:l.title||"",destination_country:l.destination_country||"",destination_city:l.destination_city||"",description:l.description||"",budget:l.budget||"",days:l.days||""}),[v,h]=m.useState(null),[j,N]=m.useState(l.image?`/storage/${l.image}`:null),[x,f]=m.useState(null),[n,d]=m.useState([]);m.useEffect(()=>{if(Array.isArray(l.stops)){console.log("Existing stops:",l.stops);const s=l.stops.map(t=>({places:[...t.filter(a=>a.trim()!==""),""],error:""}));console.log("Stops with inputs:",s),d(s)}},[l.stops]);const y=s=>{s.target.files&&s.target.files[0]&&(f(s.target.files[0]),N(URL.createObjectURL(s.target.files[0])))},i=s=>{const{name:t,value:a}=s.target;b({...o,[t]:a})},C=async s=>{s.preventDefault();const t=new FormData;for(let a in o)t.append(a,o[a]);t.append("stops",JSON.stringify(n)),x&&t.append("image",x);try{const a=await E.post(`/routes/${l.id}/update`,t,{headers:{"Content-Type":"multipart/form-data"}});alert("Route updated successfully!")}catch(a){alert("Failed to update route."),console.error(a)}},D=(s,t,a)=>{const c=[...n];c[s].places[t]=a,a.trim()!==""&&(c[s].error=""),d(c)},F=s=>{const t=[...n];t[s].places[t[s].places.length-1].trim()!==""?t[s].places.push(""):t[s].error="Please enter a place before adding another.",d(t)},S=(s,t)=>{const a=[...n];a[s].places.splice(t,1),d(a)},w=s=>{const t=[...n];t.splice(s,1),d(t)};return e.jsx("section",{className:"create-route-section py-5",children:e.jsxs(P,{children:[e.jsx("h2",{className:"text-center mb-4 section-title",children:"Edit Route"}),e.jsxs(r.Group,{className:"mb-4",children:[e.jsx(r.Label,{className:"upload-label",children:"Route Image"}),e.jsxs("div",{className:"custom-file-upload-wrapper",children:[e.jsx("input",{type:"file",accept:"image/*",id:"routeImage",onChange:y,className:"d-none"}),e.jsx("label",{htmlFor:"routeImage",className:"btn btn-upload-custom",children:"Upload Image"})]}),j&&e.jsx("div",{className:"upload-preview mt-3",children:e.jsx("img",{src:j,alt:"Route Preview"})})]}),e.jsxs(r,{onSubmit:C,className:"route-form",children:[e.jsxs(r.Group,{className:"mb-4",children:[e.jsx(r.Label,{children:"Route Title"}),e.jsx(r.Control,{type:"text",name:"title",value:o.title,onChange:i})]}),e.jsxs(u,{className:"mb-4",children:[e.jsx(p,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Country"}),e.jsx(r.Control,{type:"text",name:"destination_country",value:o.destination_country,onChange:i})]})}),e.jsx(p,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"City"}),e.jsx(r.Control,{type:"text",name:"destination_city",value:o.destination_city,onChange:i})]})})]}),e.jsxs(r.Group,{className:"mb-4",children:[e.jsx(r.Label,{children:"Description"}),e.jsx(r.Control,{as:"textarea",name:"description",rows:4,value:o.description,onChange:i})]}),e.jsxs(u,{className:"mb-4",children:[e.jsx(p,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Budget"}),e.jsx(r.Control,{type:"number",name:"budget",value:o.budget,onChange:i})]})}),e.jsx(p,{md:6,children:e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Days"}),e.jsx(r.Control,{type:"number",name:"days",value:o.days,onChange:i,readOnly:!0})]})})]}),e.jsxs("div",{className:"day-cards-wrapper",children:[console.log("Stops:",n.length),n.length>0&&e.jsx(u,{children:n.map((s,t)=>e.jsx(p,{md:4,className:"mb-4",children:e.jsxs("div",{className:"day-card p-3",children:[e.jsxs("h5",{className:"text-center mb-3",children:["Day ",t+1]}),e.jsxs("div",{className:"places-input-group mb-2",children:[e.jsx(r.Control,{type:"text",value:s.places[s.places.length-1]||"",onChange:a=>D(t,s.places.length-1,a.target.value)}),e.jsx("button",{className:"add-btn-img",type:"button",onClick:()=>F(t),onMouseEnter:()=>h(t),onMouseLeave:()=>h(null),children:e.jsx("img",{src:v===t?G:O,alt:"Add",className:"add-icon"})})]}),e.jsx("div",{className:"error-text",children:s.error||" "}),e.jsx("div",{className:"added-places mt-3",children:s.places.filter((a,c)=>c!==s.places.length-1&&a.trim()!=="").map((a,c)=>e.jsxs("div",{className:"place-tag",children:[a,e.jsx("button",{className:"remove-btn-img",onClick:()=>S(t,c),children:e.jsx("img",{src:R,alt:"Remove",className:"remove-icon"})})]},c))}),e.jsx("div",{className:"text-end mt-3",children:e.jsx(g,{variant:"outline-danger",size:"sm",onClick:()=>w(t),children:"Delete Day"})})]})},t))})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(g,{variant:"success",type:"submit",className:"px-5",children:"Update Route"})})]})]})})}const T="/build/assets/bg24-IdO12RaO.jpg";function I({route:l}){return e.jsxs(e.Fragment,{children:[e.jsx(L,{}),e.jsxs("div",{className:"edit-route-hero",style:{backgroundImage:`url(${T})`},children:[e.jsx("div",{className:"my-routes-hero-overlay"}),e.jsxs("div",{className:"hero-content edit-hero-content px-3",children:[e.jsx("h1",{className:"hero-title py-2",children:"EDIT YOUR ROUTE"}),e.jsx("p",{className:"hero-description py-1",children:"Update your destination, days, or must-see places."})]})]}),e.jsx(U,{existingRoute:l}),e.jsx(_,{})]})}export{I as default};
